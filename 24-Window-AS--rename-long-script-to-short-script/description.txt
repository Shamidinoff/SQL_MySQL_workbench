- - - Сложно ли было выполнить задание после лекций и предыдущих заданий? Пришлось ли Вам прибегать к подсказке? 

Думаю, что сложности не было (даже если Вы прибегали к подсказке) - как минимум Вы легко понимали скрипт и уверенно представляли какие именно произойдут вычисления.

- - - В чем может быть бизнес-смысл такой таблицы? 

Бизнес-смысл в том, что мы в ней видим по каждому сотруднику его результаты тестов - и сразу рядом в строке средний бал по его отделу. Благодаря таким вычислениям на уровне приложений\ПО при подключении к такой БД можно вывести каждому сотруднику его бал и рядом бал по отделу. 

Другие примеры, где есть польза от такой таблицы:

· Список компаний\филиалов с их доходами относительно дохода по всей отрасли или своему региону.

· Списки абитуриентов на факультет в ВУЗ, где окнами будут предметы – и каждый абитуриент будет видеть свою оценку и рядом средний бал по всем другим абитуриентам на этот факультет сдающим этот предмет

· Или список товаров отдела по продаже ПК, а окнами станут марки фирм-производителей ПК – и возле каждого ПК допустим будет видна его "витринная цена" и реальная средняя цена продажи по его марке с учетом всех скидок\акций\бонусов.

· Или как я говорил ранее в лекциях: к примеру, на онлайн платформе образования я как преподаватель вижу средний рейтинг каждого моего курса в сравнении с рейтингом по всей категории к которой относится конкретный мой курс. Но это я вижу выгруженный из БД показатель – а внутри БД чтобы показать мне эти 2 рейтинга SQL-скрипт делает оконное вычисление, усредняя балы по всем курсам в этой категории - и заполняет ими таблицу.

- - - Вы уловили суть функции WINDOW?


Надеюсь после такого простого задания стало понятно (а кто понял еще по лекции и предыдущему заданию - тот закрепил понимание). Функция WINDOW позволяет сформировать в конце скрипта именованное окно (или набор окон), имена которых можно подставлять в over вместо выражений, формирующих эти окна.

Это очень удобно и с т.з. читабельности скрипта, и с функциональности для пользователей - ведь когда окон много  (а еще если они в придачу сложные и многоуровневые) и надо менять их в вычислениях, то проще подставить буквы, чем копировать\вставлять целые выражения.

Ну а то что для формирования окна мы сначала пишем WINDOW имя AS (partition by Столбец1 order by Столбец2),  т.е. указываем имя окна и вставляем через AS часть формирующую само окно - это само собой на данном этапе для Вас уже понятно.